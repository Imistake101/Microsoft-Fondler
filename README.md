Credit to infradragon for the original script.
